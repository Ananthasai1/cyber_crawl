<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üï∑Ô∏è CyberCrawl - Spider Robot Control</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üï∑Ô∏è</text></svg>">
</head>
<body>
    <!-- Animated background -->
    <div class="stars"></div>
    
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="title">
                <div class="spider-icon">üï∑Ô∏è</div>
                <div>
                    <h1>CyberCrawl</h1>
                    <p class="subtitle">Spider Robot Control System v2.0</p>
                </div>
            </div>
            <div class="status-badge" id="statusBadge">
                <span class="status-dot"></span>
                <span class="status-text">INITIALIZING</span>
            </div>
        </header>

        <!-- Main Content Grid -->
        <div class="main-grid">
            <!-- Video Feed Section -->
            <div class="panel video-panel">
                <div class="panel-header">
                    <div>
                        <h2>üìπ Live Camera Feed</h2>
                        <p class="panel-subtitle">YOLOv8 Real-time Detection</p>
                    </div>
                    <div class="detection-badge" id="detectionCount">
                        <span class="badge-value">0</span>
                        <span class="badge-label">Objects</span>
                    </div>
                </div>
                
                <div class="video-wrapper">
                    <div class="video-container">
                        <img id="videoFeed" src="{{ url_for('video_feed') }}" alt="Live Camera Feed">
                        
                        <!-- Overlay Info -->
                        <div class="overlay-info">
                            <div class="info-box">
                                <span class="icon">üìè</span>
                                <span class="value" id="distanceValue">-- cm</span>
                            </div>
                            <div class="info-box">
                                <span class="icon">‚ö°</span>
                                <span class="value" id="fpsDisplay">-- fps</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Detections List -->
                <div class="detections-container">
                    <h3>üéØ Detected Objects</h3>
                    <div class="detections-list" id="detectionsList">
                        <p class="no-detections">No objects detected</p>
                    </div>
                </div>
            </div>

            <!-- Control Panel Section -->
            <div class="panel control-panel">
                <div class="panel-header">
                    <div>
                        <h2>üéÆ Robot Control</h2>
                        <p class="panel-subtitle">Manual & Autonomous Modes</p>
                    </div>
                </div>

                <!-- Mode Buttons -->
                <div class="mode-buttons">
                    <button id="btnAutoMode" class="btn btn-auto" onclick="startAutoMode()" 
                            title="Start autonomous navigation with obstacle avoidance">
                        <span class="btn-emoji">ü§ñ</span>
                        <span>Auto Mode</span>
                    </button>
                    <button id="btnManualMode" class="btn btn-manual" onclick="enableManualMode()" 
                            title="Switch to manual control via keyboard or buttons">
                        <span class="btn-emoji">‚öôÔ∏è</span>
                        <span>Manual Mode</span>
                    </button>
                    <button id="btnStop" class="btn btn-stop" onclick="stopRobot()" 
                            title="Emergency stop - halt all movement">
                        <span class="btn-emoji">üõë</span>
                        <span>Stop</span>
                    </button>
                </div>

                <!-- Manual Controls (Hidden by default) -->
                <div id="manualControls" class="manual-controls" style="display: none;">
                    <!-- Direction Pad -->
                    <div class="control-section">
                        <h3>Direction Control</h3>
                        <div class="direction-pad">
                            <div class="pad-grid">
                                <div></div>
                                <button class="btn-dir" onclick="manualControl('forward')" 
                                        title="Move forward (‚Üë or W)">‚¨ÜÔ∏è</button>
                                <div></div>
                                
                                <button class="btn-dir" onclick="manualControl('left')" 
                                        title="Turn left (‚Üê or A)">‚¨ÖÔ∏è</button>
                                <div class="center-spider">üï∑Ô∏è</div>
                                <button class="btn-dir" onclick="manualControl('right')" 
                                        title="Turn right (‚Üí or D)">‚û°Ô∏è</button>
                                
                                <div></div>
                                <button class="btn-dir" onclick="manualControl('backward')" 
                                        title="Move backward (‚Üì or S)">‚¨áÔ∏è</button>
                                <div></div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="control-section">
                        <h3>Actions & Gestures</h3>
                        <div class="action-buttons">
                            <button class="btn btn-action" onclick="manualControl('wave')">üëã Wave</button>
                            <button class="btn btn-action" onclick="manualControl('shake')">ü§ù Shake</button>
                            <button class="btn btn-action" onclick="manualControl('dance')">üíÉ Dance</button>
                            <button class="btn btn-action" onclick="manualControl('stand')">üßç Stand</button>
                            <button class="btn btn-action" onclick="manualControl('sit')">üí∫ Sit</button>
                        </div>
                    </div>
                </div>

                <!-- Status Panel -->
                <div class="status-panel">
                    <h3>üìä System Status</h3>
                    <div class="status-grid">
                        <div class="status-row">
                            <span class="status-label">Mode</span>
                            <span class="status-value" id="modeText">STOPPED</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">Distance</span>
                            <span class="status-value" id="distanceText">-- cm</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">Objects</span>
                            <span class="status-value" id="detectionsText">0</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">FPS</span>
                            <span class="status-value" id="fpsText">-- fps</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">Camera</span>
                            <span class="status-value" id="cameraStatus">Checking...</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">YOLO</span>
                            <span class="status-value" id="modelStatus">Loading...</span>
                        </div>
                    </div>
                </div>

                <!-- Keyboard Hint -->
                <div class="keyboard-hint">
                    <p>‚å®Ô∏è <strong>Keyboard:</strong> Arrow Keys or WASD ‚Ä¢ Space to Stop</p>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>üï∑Ô∏è <strong>CyberCrawl Spider Robot</strong> ¬© 2025</p>
            <p>Raspberry Pi 3 ‚Ä¢ OV5647 Camera ‚Ä¢ YOLOv8</p>
        </footer>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- JavaScript -->
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>